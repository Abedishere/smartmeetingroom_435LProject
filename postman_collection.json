{
  "info": {
    "name": "Smart Meeting Room Management System",
    "description": "API collection for Users and Rooms services with authentication and role-based access control",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url_users",
      "value": "http://localhost:5001",
      "type": "string"
    },
    {
      "key": "base_url_rooms",
      "value": "http://localhost:5002",
      "type": "string"
    },
    {
      "key": "access_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "base_url_bookings",
      "value": "http://localhost:5003",
      "type": "string"
    },
    {
      "key": "base_url_reviews",
      "value": "http://localhost:5004",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Users Service",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url_users}}/api/users/health",
              "host": ["{{base_url_users}}"],
              "path": ["api", "users", "health"]
            },
            "description": "Check if Users Service is running and healthy"
          },
          "response": []
        },
        {
          "name": "Register User",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    pm.environment.set('user_id', pm.response.json().user.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Admin User\",\n    \"username\": \"admin\",\n    \"password\": \"Admin123\",\n    \"email\": \"admin@example.com\",\n    \"role\": \"admin\"\n}"
            },
            "url": {
              "raw": "{{base_url_users}}/api/users/register",
              "host": ["{{base_url_users}}"],
              "path": ["api", "users", "register"]
            },
            "description": "Register a new user account. Required fields: name, username, password, email. Optional: role (default: regular_user). Valid roles: admin, regular_user, facility_manager, moderator, auditor, service_account"
          },
          "response": []
        },
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    pm.collectionVariables.set('access_token', pm.response.json().access_token);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"username\": \"admin\",\n    \"password\": \"Admin123\"\n}"
            },
            "url": {
              "raw": "{{base_url_users}}/api/users/login",
              "host": ["{{base_url_users}}"],
              "path": ["api", "users", "login"]
            },
            "description": "Authenticate user and receive JWT access token. Token expires in 1 hour. Required fields: username, password"
          },
          "response": []
        },
        {
          "name": "Get All Users (Admin)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_users}}/api/users/",
              "host": ["{{base_url_users}}"],
              "path": ["api", "users", ""]
            },
            "description": "Get all users in the system. Requires Admin or Auditor role."
          },
          "response": []
        },
        {
          "name": "Get User by Username",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_users}}/api/users/admin",
              "host": ["{{base_url_users}}"],
              "path": ["api", "users", "admin"]
            },
            "description": "Get specific user by username. Admin/Auditor can view any user, regular users can only view their own profile."
          },
          "response": []
        },
        {
          "name": "Get Current User Profile",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_users}}/api/users/me",
              "host": ["{{base_url_users}}"],
              "path": ["api", "users", "me"]
            },
            "description": "Get current authenticated user's profile information"
          },
          "response": []
        },
        {
          "name": "Update User",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Updated Name\",\n    \"email\": \"updated@example.com\"\n}"
            },
            "url": {
              "raw": "{{base_url_users}}/api/users/1",
              "host": ["{{base_url_users}}"],
              "path": ["api", "users", "1"]
            },
            "description": "Update user information. Admin can update any user, regular users can only update their own profile. Only admin can change roles. Optional fields: name, email, password, role (admin only)"
          },
          "response": []
        },
        {
          "name": "Delete User (Admin)",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_users}}/api/users/2",
              "host": ["{{base_url_users}}"],
              "path": ["api", "users", "2"]
            },
            "description": "Delete a user account. Requires Admin role."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Rooms Service",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url_rooms}}/api/rooms/health",
              "host": ["{{base_url_rooms}}"],
              "path": ["api", "rooms", "health"]
            },
            "description": "Check if Rooms Service is running and healthy"
          },
          "response": []
        },
        {
          "name": "Create Room (Admin/FM)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    pm.environment.set('room_id', pm.response.json().room.id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Conference Room A\",\n    \"capacity\": 10,\n    \"equipment\": [\"Projector\", \"Whiteboard\", \"Video Conference\"],\n    \"location\": \"Building 1, Floor 2, Room 201\"\n}"
            },
            "url": {
              "raw": "{{base_url_rooms}}/api/rooms/",
              "host": ["{{base_url_rooms}}"],
              "path": ["api", "rooms", ""]
            },
            "description": "Create a new meeting room. Requires Admin or Facility Manager role. Required fields: name (2-100 chars), capacity (1-1000), location. Optional: equipment (list of equipment items)"
          },
          "response": []
        },
        {
          "name": "Get All Rooms",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_rooms}}/api/rooms/",
              "host": ["{{base_url_rooms}}"],
              "path": ["api", "rooms", ""]
            },
            "description": "Get all rooms in the system. Requires authentication."
          },
          "response": []
        },
        {
          "name": "Search Available Rooms",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_rooms}}/api/rooms/search?capacity=10&location=Building 1&equipment=Projector,Whiteboard",
              "host": ["{{base_url_rooms}}"],
              "path": ["api", "rooms", "search"],
              "query": [
                {
                  "key": "capacity",
                  "value": "10",
                  "description": "Minimum capacity required"
                },
                {
                  "key": "location",
                  "value": "Building 1",
                  "description": "Location filter (partial match)"
                },
                {
                  "key": "equipment",
                  "value": "Projector,Whiteboard",
                  "description": "Required equipment (comma-separated)"
                }
              ]
            },
            "description": "Search for available rooms based on criteria. All query parameters are optional. Only returns rooms with status='available'."
          },
          "response": []
        },
        {
          "name": "Get Room by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_rooms}}/api/rooms/1",
              "host": ["{{base_url_rooms}}"],
              "path": ["api", "rooms", "1"]
            },
            "description": "Get specific room details by ID. Requires authentication."
          },
          "response": []
        },
        {
          "name": "Update Room (Admin/FM)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Updated Conference Room A\",\n    \"capacity\": 15,\n    \"equipment\": [\"Projector\", \"Whiteboard\", \"Video Conference\", \"Smart TV\"],\n    \"location\": \"Building 1, Floor 2, Room 201\"\n}"
            },
            "url": {
              "raw": "{{base_url_rooms}}/api/rooms/1",
              "host": ["{{base_url_rooms}}"],
              "path": ["api", "rooms", "1"]
            },
            "description": "Update room information. Requires Admin or Facility Manager role. All fields are optional: name, capacity, equipment, location, status"
          },
          "response": []
        },
        {
          "name": "Update Room Status (Admin/FM)",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"status\": \"out_of_service\"\n}"
            },
            "url": {
              "raw": "{{base_url_rooms}}/api/rooms/1/status",
              "host": ["{{base_url_rooms}}"],
              "path": ["api", "rooms", "1", "status"]
            },
            "description": "Update room status. Requires Admin or Facility Manager role. Valid statuses: available, booked, out_of_service"
          },
          "response": []
        },
        {
          "name": "Delete Room (Admin/FM)",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_rooms}}/api/rooms/1",
              "host": ["{{base_url_rooms}}"],
              "path": ["api", "rooms", "1"]
            },
            "description": "Delete a room. Requires Admin or Facility Manager role."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Bookings Service",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url_bookings}}/health",
              "host": ["{{base_url_bookings}}"],
              "path": ["health"]
            },
            "description": "Check if Bookings Service is running and healthy"
          },
          "response": []
        },
        {
          "name": "List All Bookings (Admin/FM/Auditor)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_bookings}}/bookings",
              "host": ["{{base_url_bookings}}"],
              "path": ["bookings"]
            },
            "description": "Get all bookings in the system. Requires Admin, Facility Manager, or Auditor role. Returns booking details with user and room information."
          },
          "response": []
        },
        {
          "name": "Get Booking by ID (Admin/FM/Auditor)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_bookings}}/bookings/1",
              "host": ["{{base_url_bookings}}"],
              "path": ["bookings", "1"]
            },
            "description": "Get specific booking by ID. Requires Admin, Facility Manager, or Auditor role."
          },
          "response": []
        },
        {
          "name": "Get User Booking History",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_bookings}}/bookings/user/admin",
              "host": ["{{base_url_bookings}}"],
              "path": ["bookings", "user", "admin"]
            },
            "description": "Get booking history for a specific user. Users can view their own bookings. Admin/FM/Auditor can view any user's bookings."
          },
          "response": []
        },
        {
          "name": "Create Booking",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    pm.environment.set('booking_id', pm.response.json().id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"user_id\": 1,\n    \"room_id\": 1,\n    \"start_time\": \"2025-12-01T10:00:00\",\n    \"end_time\": \"2025-12-01T12:00:00\"\n}"
            },
            "url": {
              "raw": "{{base_url_bookings}}/bookings",
              "host": ["{{base_url_bookings}}"],
              "path": ["bookings"]
            },
            "description": "Create a new booking. Required fields: room_id, start_time, end_time, and either user_id or username. Checks for time conflicts. Requires regular_user, facility_manager, admin, or service_account role."
          },
          "response": []
        },
        {
          "name": "Update Booking",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"start_time\": \"2025-12-01T14:00:00\",\n    \"end_time\": \"2025-12-01T16:00:00\",\n    \"room_id\": 2\n}"
            },
            "url": {
              "raw": "{{base_url_bookings}}/bookings/1",
              "host": ["{{base_url_bookings}}"],
              "path": ["bookings", "1"]
            },
            "description": "Update booking time or room. All fields optional. Owner, Admin, or Facility Manager can update. Checks for conflicts with new time/room."
          },
          "response": []
        },
        {
          "name": "Cancel Booking",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_bookings}}/bookings/1",
              "host": ["{{base_url_bookings}}"],
              "path": ["bookings", "1"]
            },
            "description": "Cancel a booking by setting status to 'cancelled'. Owner, Admin, or Facility Manager can cancel. Returns 204 No Content on success."
          },
          "response": []
        },
        {
          "name": "Check Room Availability",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_bookings}}/bookings/check-availability?room_id=1&start_time=2025-12-01T10:00:00&end_time=2025-12-01T12:00:00",
              "host": ["{{base_url_bookings}}"],
              "path": ["bookings", "check-availability"],
              "query": [
                {
                  "key": "room_id",
                  "value": "1",
                  "description": "Room identifier (required)"
                },
                {
                  "key": "start_time",
                  "value": "2025-12-01T10:00:00",
                  "description": "Proposed start time (required)"
                },
                {
                  "key": "end_time",
                  "value": "2025-12-01T12:00:00",
                  "description": "Proposed end time (required)"
                }
              ]
            },
            "description": "Check if a room is available for a given time window. Returns {available: true/false}. end_time must be after start_time."
          },
          "response": []
        }
      ]
    },
    {
      "name": "Reviews Service",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url_reviews}}/health",
              "host": ["{{base_url_reviews}}"],
              "path": ["health"]
            },
            "description": "Check if Reviews Service is running and healthy"
          },
          "response": []
        },
        {
          "name": "Create Review",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    pm.environment.set('review_id', pm.response.json().id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"room_id\": 1,\n    \"rating\": 5,\n    \"comment\": \"Excellent conference room with great equipment!\"\n}"
            },
            "url": {
              "raw": "{{base_url_reviews}}/reviews",
              "host": ["{{base_url_reviews}}"],
              "path": ["reviews"]
            },
            "description": "Create a review for a room. Required fields: room_id, rating (1-5), comment (must not be empty). Comment is sanitized to remove unsafe HTML. Requires regular_user, facility_manager, or admin role."
          },
          "response": []
        },
        {
          "name": "Update Review",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"rating\": 4,\n    \"comment\": \"Updated review: Very good room but could use better lighting.\"\n}"
            },
            "url": {
              "raw": "{{base_url_reviews}}/reviews/1",
              "host": ["{{base_url_reviews}}"],
              "path": ["reviews", "1"]
            },
            "description": "Update an existing review. Required fields: rating (1-5), comment. Only review owner or admin can update. Comment is sanitized."
          },
          "response": []
        },
        {
          "name": "Delete Review",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_reviews}}/reviews/1",
              "host": ["{{base_url_reviews}}"],
              "path": ["reviews", "1"]
            },
            "description": "Delete a review. Owner, Moderator, or Admin can delete. Returns 204 No Content on success."
          },
          "response": []
        },
        {
          "name": "Get Reviews for Room",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_reviews}}/reviews/room/1?min_rating=3&flagged_only=false",
              "host": ["{{base_url_reviews}}"],
              "path": ["reviews", "room", "1"],
              "query": [
                {
                  "key": "min_rating",
                  "value": "3",
                  "description": "Filter by minimum rating (1-5, optional)"
                },
                {
                  "key": "flagged_only",
                  "value": "false",
                  "description": "Show only flagged reviews (optional, default: false)"
                }
              ]
            },
            "description": "Get all reviews for a specific room. Optional filters: min_rating (1-5) and flagged_only (boolean). Returns list of reviews with user information."
          },
          "response": []
        },
        {
          "name": "Flag Review",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_reviews}}/reviews/1/flag",
              "host": ["{{base_url_reviews}}"],
              "path": ["reviews", "1", "flag"]
            },
            "description": "Flag a review as inappropriate. Any regular_user, moderator, or admin can flag. Sets flagged=true on the review."
          },
          "response": []
        },
        {
          "name": "Unflag Review (Moderator/Admin)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url_reviews}}/reviews/1/unflag",
              "host": ["{{base_url_reviews}}"],
              "path": ["reviews", "1", "unflag"]
            },
            "description": "Remove a flag from a review. Requires Moderator or Admin role. Sets flagged=false on the review."
          },
          "response": []
        }
      ]
    }
  ]
}
